{"version":3,"file":"d3-annotation.independent.js","sources":["src/Annotation.js","src/AnnotationCollection.js","src/Handles.js","src/Note/alignment.js","src/Builder.js","src/Note/lineType-vertical.js","src/Note/lineType-horizontal.js","src/Connector/type-line.js","src/Connector/type-elbow.js","src/Connector/type-curve.js","src/Connector/end-arrow.js","src/Connector/end-dot.js","src/Subject/circle.js","src/Subject/rect.js","src/Subject/threshold.js","src/Subject/badge.js","src/Types-d3.js","src/Adapter-d3.js","index.js"],"sourcesContent":["export default class Annotation {\r\n  constructor({\r\n    x = 0,\r\n    y = 0,\r\n    nx,\r\n    ny,\r\n    dy = 0,\r\n    dx = 0,\r\n    color = \"grey\",\r\n    data,\r\n    type,\r\n    subject,\r\n    connector,\r\n    note,\r\n    disable,\r\n    id,\r\n    className\r\n  }) {\r\n    this._dx = nx !== undefined ? nx - x : dx\r\n    this._dy = ny !== undefined ? ny - y : dy\r\n    this._x = x\r\n    this._y = y\r\n    this._color = color\r\n    this.id = id\r\n    this._className = className || \"\"\r\n\r\n    this._type = type || \"\"\r\n    this.data = data\r\n\r\n    this.note = note || {}\r\n    this.connector = connector || {}\r\n    this.subject = subject || {}\r\n\r\n    this.disable = disable || []\r\n  }\r\n\r\n  updatePosition() {\r\n    if (this.type.setPosition) {\r\n      this.type.setPosition()\r\n      if (\r\n        this.type.subject &&\r\n        this.type.subject.selectAll(\":not(.handle)\").nodes().length !== 0\r\n      ) {\r\n        this.type.redrawSubject()\r\n      }\r\n    }\r\n  }\r\n\r\n  clearComponents() {\r\n    this.type.clearComponents && this.type.clearComponents()\r\n  }\r\n\r\n  get className() {\r\n    return this._className\r\n  }\r\n\r\n  set className(className) {\r\n    this._className = className\r\n    if (this.type.setClassName) this.type.setClassName()\r\n  }\r\n\r\n  updateOffset() {\r\n    if (this.type.setOffset) {\r\n      this.type.setOffset()\r\n\r\n      if (this.type.connector.selectAll(\":not(.handle)\").nodes().length !== 0) {\r\n        this.type.redrawConnector()\r\n      }\r\n\r\n      this.type.redrawNote()\r\n    }\r\n  }\r\n\r\n  get type() {\r\n    return this._type\r\n  }\r\n\r\n  set type(type) {\r\n    this._type = type\r\n    this.clearComponents()\r\n  }\r\n\r\n  get x() {\r\n    return this._x\r\n  }\r\n  set x(x) {\r\n    this._x = x\r\n    this.updatePosition()\r\n  }\r\n\r\n  get y() {\r\n    return this._y\r\n  }\r\n  set y(y) {\r\n    this._y = y\r\n    this.updatePosition()\r\n  }\r\n\r\n  get color() {\r\n    return this._color\r\n  }\r\n  set color(color) {\r\n    this._color = color\r\n    this.updatePosition()\r\n  }\r\n\r\n  get dx() {\r\n    return this._dx\r\n  }\r\n  set dx(dx) {\r\n    this._dx = dx\r\n    this.updateOffset()\r\n  }\r\n\r\n  get dy() {\r\n    return this._dy\r\n  }\r\n  set dy(dy) {\r\n    this._dy = dy\r\n    this.updateOffset()\r\n  }\r\n\r\n  set nx(nx) {\r\n    this._dx = nx - this._x\r\n    this.updateOffset()\r\n  }\r\n\r\n  set ny(ny) {\r\n    this._dy = ny - this._y\r\n    this.updateOffset()\r\n  }\r\n\r\n  get offset() {\r\n    return { x: this._dx, y: this._dy }\r\n  }\r\n\r\n  set offset({ x, y }) {\r\n    this._dx = x\r\n    this._dy = y\r\n    this.updateOffset()\r\n  }\r\n\r\n  get position() {\r\n    return { x: this._x, y: this._y }\r\n  }\r\n\r\n  set position({ x, y }) {\r\n    this._x = x\r\n    this._y = y\r\n    this.updatePosition()\r\n  }\r\n\r\n  get translation() {\r\n    return {\r\n      x: this._x + this._dx,\r\n      y: this._y + this._dy\r\n    }\r\n  }\r\n\r\n  get json() {\r\n    const json = {\r\n      x: this._x,\r\n      y: this._y,\r\n      dx: this._dx,\r\n      dy: this._dy\r\n    }\r\n\r\n    if (this.data && Object.keys(this.data).length > 0) json.data = this.data\r\n    if (this.type) json.type = this.type\r\n    if (this._className) json.className = this._className\r\n\r\n    if (Object.keys(this.connector).length > 0) json.connector = this.connector\r\n    if (Object.keys(this.subject).length > 0) json.subject = this.subject\r\n    if (Object.keys(this.note).length > 0) json.note = this.note\r\n\r\n    return json\r\n  }\r\n}\r\n","export default class AnnotationCollection {\r\n\r\n  constructor ({ annotations, accessors, accessorsInverse }) {\r\n    this.accessors = accessors\r\n    this.accessorsInverse = accessorsInverse\r\n    this.annotations = annotations\r\n  }\r\n\r\n  clearTypes (newSettings) {\r\n    this.annotations.forEach(d => {\r\n      d.type = undefined\r\n      d.subject = newSettings && newSettings.subject || d.subject\r\n      d.connector = newSettings && newSettings.connector || d.connector\r\n      d.note = newSettings && newSettings.note || d.note\r\n    })\r\n  }\r\n\r\n  setPositionWithAccessors () {\r\n    this.annotations.forEach(d => {\r\n      d.type.setPositionWithAccessors(this.accessors)\r\n    })\r\n  }\r\n\r\n  editMode (editMode) { this.annotations.forEach(a => {\r\n    if (a.type) {\r\n      a.type.editMode = editMode\r\n      a.type.updateEditMode()\r\n    }\r\n  })\r\n  }\r\n\r\n  updateDisable (disable) {\r\n    this.annotations.forEach(a => {\r\n      a.disable = disable\r\n      if (a.type) {\r\n        disable.forEach(d => {\r\n          if (a.type[d]) {\r\n            a.type[d].remove && a.type[d].remove()\r\n            a.type[d] = undefined\r\n          }\r\n        })\r\n      }\r\n    })\r\n  }\r\n\r\n  updateTextWrap (textWrap) {\r\n    this.annotations.forEach(a => {\r\n      if (a.type && a.type.updateTextWrap) {\r\n        a.type.updateTextWrap(textWrap)\r\n      }\r\n    })\r\n  }\r\n\r\n  updateText () {\r\n    this.annotations.forEach(a => {\r\n      if (a.type && a.type.drawText) {\r\n        a.type.drawText()\r\n      }\r\n    })\r\n  }\r\n\r\n  updateNotePadding (notePadding) {\r\n    this.annotations.forEach(a => {\r\n      if (a.type) {\r\n        a.type.notePadding = notePadding\r\n      }\r\n    })\r\n  }\r\n\r\n  get json () { \r\n    return this.annotations.map(a => {      \r\n      const json = a.json\r\n      if (this.accessorsInverse && a.data) {\r\n        json.data = {}\r\n        Object.keys(this.accessorsInverse).forEach(k => {\r\n          json.data[k] = this.accessorsInverse[k]({ x: a.x, y: a.y})\r\n\r\n          //TODO make this feasible to map back to data for other types of subjects\r\n        })\r\n      }\r\n      return json\r\n    })\r\n  }\r\n\r\n  get noteNodes () {\r\n    return this.annotations.map(a => ({ ...a.type.getNoteBBoxOffset(), positionX: a.x, positionY: a.y }))\r\n  }\r\n\r\n  //TODO: come back and rethink if a.x and a.y are applicable in all situations\r\n  // get connectorNodes() {\r\n  //   return this.annotations.map(a => ({ ...a.type.getConnectorBBox(), startX: a.x, startY: a.y}))\r\n  // }\r\n\r\n  // get subjectNodes() {\r\n  //   return this.annotations.map(a => ({ ...a.type.getSubjectBBox(), startX: a.x, startY: a.y}))\r\n  // }\r\n\r\n  // get annotationNodes() {\r\n  //   return this.annotations.map(a => ({ ...a.type.getAnnotationBBox(), startX: a.x, startY: a.y}))\r\n  // }\r\n}\r\n","import { select } from \"d3-selection\"\r\nimport { drag } from \"d3-drag\"\r\n\r\nexport const pointHandle = ({ cx = 0, cy = 0 }) => {\r\n  return { move: { x: cx, y: cy } }\r\n}\r\n\r\nexport const circleHandles = ({ cx = 0, cy = 0, r1, r2, padding }) => {\r\n  const h = { move: { x: cx, y: cy } }\r\n\r\n  if (r1 !== undefined) {\r\n    h.r1 = { x: cx + r1 / Math.sqrt(2), y: cy + r1 / Math.sqrt(2) }\r\n  }\r\n\r\n  if (r2 !== undefined) {\r\n    h.r2 = { x: cx + r2 / Math.sqrt(2), y: cy + r2 / Math.sqrt(2) }\r\n  }\r\n\r\n  if (padding !== undefined) {\r\n    h.padding = { x: cx + r1 + padding, y: cy }\r\n  }\r\n\r\n  return h\r\n}\r\n\r\nexport const rectHandles = ({\r\n  x1 = 0,\r\n  y1 = 0,\r\n  x2 = x1,\r\n  y2 = y1,\r\n  width,\r\n  height\r\n}) => {\r\n  const w = width || Math.abs(x2 - x1)\r\n  const h = height || Math.abs(y2 - y1)\r\n\r\n  return {\r\n    move: {\r\n      x: Math.min(x1, x2) + w / 2,\r\n      y: Math.min(y1, y2) - 10\r\n    },\r\n    width: {\r\n      x: Math.max(x1, x2),\r\n      y: Math.min(y1, y2) + h / 2\r\n    },\r\n    height: {\r\n      x: Math.min(x1, x2) + w / 2,\r\n      y: Math.max(y1, y2)\r\n    }\r\n  }\r\n}\r\n\r\nexport const lineHandles = ({ x1, y1, x2, y2, x, y }) => {\r\n  const minY = Math.min(y1, y2)\r\n  const minX = Math.min(x1, x2)\r\n\r\n  const height = Math.abs(y2 - y1)\r\n  const width = Math.abs(x2 - x1)\r\n\r\n  return {\r\n    move: {\r\n      x: x || minX + width / 2,\r\n      y: y || minY + height / 2\r\n    }\r\n  }\r\n}\r\n\r\n//arc handles\r\nexport const addHandles = ({ group, handles, r = 10 }) => {\r\n  //give it a group and x,y to draw handles\r\n  //then give it instructions on what the handles change\r\n  const h = group.selectAll(\"circle.handle\").data(handles)\r\n\r\n  h\r\n    .enter()\r\n    .append(\"circle\")\r\n    .attr(\"class\", \"handle\")\r\n    .attr(\"fill\", \"grey\")\r\n    .attr(\"fill-opacity\", 0.1)\r\n    .attr(\"cursor\", \"move\")\r\n    .attr(\"stroke-dasharray\", 5)\r\n    .attr(\"stroke\", \"grey\")\r\n    .call(\r\n      drag()\r\n        .container(select(\"g.annotations\").node())\r\n        .on(\"start\", d => d.start && d.start(d))\r\n        .on(\"drag\", d => d.drag && d.drag(d))\r\n        .on(\"end\", d => d.end && d.end(d))\r\n    )\r\n\r\n  group\r\n    .selectAll(\"circle.handle\")\r\n    .attr(\"cx\", d => d.x)\r\n    .attr(\"cy\", d => d.y)\r\n    .attr(\"r\", d => d.r || r)\r\n    .attr(\"class\", d => `handle ${d.className || \"\"}`)\r\n\r\n  h.exit().remove()\r\n}\r\n","\r\nexport const leftRightDynamic = (align, y) => {\r\n  if (align === \"dynamic\" || align === \"left\" || align === \"right\") {\r\n    if (y < 0) { align = \"top\" }\r\n    else { align = \"bottom\" } \r\n  }\r\n  return align\r\n}\r\n\r\nexport const topBottomDynamic = (align, x) => {\r\n  if (align === \"dynamic\" || align === \"top\" || align === \"bottom\") {\r\n    if (x < 0) { align = \"right\" }\r\n    else { align = \"left\" }      \r\n  }\r\n  return align\r\n}\r\n\r\nconst orientationTopBottom = [\"topBottom\", \"top\", \"bottom\"]\r\nconst orientationLeftRight = [\"leftRight\", \"left\", \"right\"]\r\n\r\nexport default ({ padding=0, bbox={x:0, y:0, width:0, height:0}, align, orientation, offset={x:0, y:0} }) => {\r\n  let x = -bbox.x \r\n  let y = 0//-bbox.y\r\n  if ( orientationTopBottom.indexOf(orientation) !== -1 ) {\r\n    align = topBottomDynamic(align, offset.x)\r\n    if (offset.y < 0 && orientation === \"topBottom\" || orientation === \"top\") { \r\n      y -= bbox.height + padding\r\n    } else {\r\n      y += padding\r\n    }\r\n\r\n    if ( align === \"middle\" ) {\r\n      x -= bbox.width/2\r\n    } else if (align === \"right\" ) {\r\n      x -= bbox.width\r\n    } \r\n\r\n  } else if ( orientationLeftRight.indexOf(orientation) !== -1 ) {\r\n    align = leftRightDynamic(align, offset.y)\r\n    if (offset.x < 0 && orientation === \"leftRight\" || orientation === \"left\") { \r\n      x -= bbox.width + padding\r\n    } else {\r\n      x += padding\r\n    }\r\n\r\n    if ( align === \"middle\" ) {\r\n      y -= bbox.height/2\r\n    } else if (align === \"top\" ) {\r\n      y -= bbox.height\r\n    }\r\n  } \r\n\r\n  return { x, y }\r\n}","import { line, arc, curveLinear } from \"d3-shape\"\r\n\r\nexport const lineBuilder = ({ data, curve=curveLinear, canvasContext, className, classID }) => { \r\n  const lineGen = line()\r\n    .curve(curve)\r\n\r\n  const builder = {\r\n    type: 'path',\r\n    className,\r\n    classID,\r\n    data\r\n  }\r\n\r\n  if (canvasContext) {\r\n    lineGen.context(canvasContext)\r\n    builder.pathMethods = lineGen\r\n\r\n  } else {\r\n    builder.attrs = {\r\n      d: lineGen(data)\r\n    }\r\n  }\r\n\r\n  return builder\r\n}\r\n\r\nexport const arcBuilder = ({ data, canvasContext, className, classID }) => {\r\n\r\n  const builder = {\r\n    type: 'path',\r\n    className,\r\n    classID,\r\n    data\r\n  }\r\n\r\n  const arcShape = arc()\r\n    .innerRadius(data.innerRadius || 0)\r\n    .outerRadius(data.outerRadius || data.radius || 2)\r\n    .startAngle(data.startAngle || 0)\r\n    .endAngle(data.endAngle || 2*Math.PI)\r\n\r\n  if (canvasContext) {\r\n    arcShape.context(canvasContext)\r\n    builder.pathMethods = lineGen\r\n\r\n  } else {\r\n    \r\n    builder.attrs = {\r\n      d: arcShape()\r\n    }\r\n  }\r\n\r\n  return builder\r\n}","import { lineBuilder } from '../Builder'\r\nimport { leftRightDynamic } from './alignment'\r\n\r\nexport default ({ align, x=0, y=0, bbox, offset }) => {\r\n  align = leftRightDynamic(align, offset.y)\r\n\r\n  if (align === \"top\") { y -= bbox.height } \r\n  else if (align === \"middle\") { y -= bbox.height/2 }\r\n\r\n  const data = [[x, y], [x, y + bbox.height]]\r\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\r\n}","import { lineBuilder } from '../Builder'\r\nimport { topBottomDynamic } from './alignment'\r\n\r\nexport default ({ align, x=0, y=0, offset, bbox }) => {\r\n  align = topBottomDynamic(align, offset.x)\r\n\r\n  if (align === \"right\") { x -= bbox.width }\r\n  else if (align === \"middle\") { x -= bbox.width/2 }\r\n\r\n  const data = [[x, y], [x + bbox.width, y]]\r\n  return { components: [lineBuilder({ data, className : \"note-line\" })] }\r\n}","import { lineBuilder } from '../Builder'\r\n\r\nexport const lineSetup = ({ type, subjectType }) => {\r\n  let annotation = type.annotation\r\n  let offset = annotation.position\r\n  \r\n  let x1 = annotation.x - offset.x,\r\n    x2 = x1 + annotation.dx,\r\n    y1 = annotation.y - offset.y,\r\n    y2 = y1 + annotation.dy\r\n\r\n\r\n  const subjectData = annotation.subject\r\n\r\n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\r\n    const h =  Math.sqrt((x1 - x2)*(x1 - x2) + (y1 - y2)*(y1 - y2))\r\n    const angle = Math.asin(-y2/h)\r\n    const r = subjectData.outerRadius || subjectData.radius + (subjectData.radiusPadding || 0)\r\n\r\n    x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\r\n    y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\r\n\r\n  }\r\n\r\n  if (subjectType === \"rect\") {\r\n    const { width, height } = subjectData\r\n    \r\n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\r\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\r\n      else x1 = width\r\n    } \r\n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\r\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\r\n      else y1 = height\r\n    }\r\n    if (x1 === width/2 && y1 === height/2) { x1 = x2; y1 = y2;}\r\n  }\r\n\r\n\r\n  return [[x1, y1], [x2, y2]]\r\n}\r\n\r\nexport default (connectorData) => {\r\n  const data = lineSetup(connectorData)\r\n  return { components: [lineBuilder({ data, className : \"connector\" })]} \r\n}","import { lineBuilder } from '../Builder'\r\n\r\nexport default ({ type, subjectType }) => {\r\n\r\n  const annotation = type.annotation\r\n  const offset = annotation.position\r\n\r\n  let x1 = annotation.x - offset.x,\r\n    x2 = x1 + annotation.dx,\r\n    y1 = annotation.y - offset.y,\r\n    y2 = y1 + annotation.dy\r\n\r\n  const subjectData = annotation.subject\r\n\r\n  if (subjectType === \"rect\") {\r\n    const { width, height } = subjectData\r\n    \r\n    if (width > 0 && annotation.dx > 0 || width < 0 && annotation.dx < 0) {\r\n      if (Math.abs(width) > Math.abs(annotation.dx)) x1 = width/2\r\n      else x1 = width\r\n    } \r\n    if (height > 0 && annotation.dy > 0 || height < 0 && annotation.dy < 0) {\r\n      if (Math.abs(height) > Math.abs(annotation.dy)) y1 = height/2\r\n      else y1 = height\r\n    }\r\n    if (x1 === width/2 && y1 === height/2) { x1 = x2; y1 = y2;}\r\n  }\r\n\r\n  let data = [[x1, y1], [x2, y2]]\r\n\r\n  let diffY = y2 - y1\r\n  let diffX = x2 - x1\r\n  let xe = x2 \r\n  let ye = y2\r\n  let opposite = y2 < y1 && x2 > x1 || x2 < x1 && y2 > y1 ? -1 : 1\r\n\r\n  if (Math.abs(diffX) < Math.abs(diffY)) {\r\n    xe = x2\r\n    ye = y1 + diffX*opposite\r\n  } else {\r\n    ye = y2\r\n    xe = x1 + diffY*opposite\r\n  }\r\n  \r\n  if (subjectType === \"circle\" && (subjectData.outerRadius || subjectData.radius)) {\r\n    const r = (subjectData.outerRadius || subjectData.radius) + (subjectData.radiusPadding || 0)\r\n    const length = r/Math.sqrt(2)\r\n\r\n    if (Math.abs(diffX) > length && Math.abs(diffY) > length) {\r\n      x1 = length*(x2 < 0 ? -1 : 1)\r\n      y1 = length*(y2 < 0 ? -1 : 1)\r\n      data = [[x1, y1], [xe , ye ], [x2, y2]]\r\n\r\n    } else if (Math.abs(diffX) > Math.abs(diffY)) {\r\n      const angle = Math.asin(-y2/r)\r\n      x1 = Math.abs(Math.cos(angle)*r)*(x2 < 0 ? -1 : 1)\r\n      data = [[ x1, y2], [x2, y2]]\r\n    } else {\r\n      const angle = Math.acos(x2/r)\r\n      y1 = Math.abs(Math.sin(angle)*r)*(y2 < 0 ? -1 : 1)\r\n      data = [[ x2, y1], [x2, y2]]\r\n    }\r\n  } else {\r\n    data = [[x1, y1], [xe , ye], [x2, y2]]\r\n  }\r\n\r\n  return { components: [lineBuilder({ data, className: \"connector\"})]}\r\n}\r\n","import { lineBuilder } from '../Builder'\r\nimport { event } from 'd3-selection'\r\nimport { lineSetup } from './type-line'\r\nimport { curveCatmullRom } from 'd3-shape'\r\nimport { pointHandle } from '../Handles'\r\n\r\nexport default ({ type, connectorData, subjectType }) => {\r\n\r\n  if (!connectorData) { connectorData = {} }\r\n  if (!connectorData.points || typeof connectorData.points === \"number\") { \r\n    connectorData.points = createPoints(type.annotation.offset, connectorData.points) \r\n  }\r\n  if (!connectorData.curve) { connectorData.curve = curveCatmullRom }\r\n\r\n  let handles = []\r\n\r\n  if (type.editMode) {\r\n    const cHandles = connectorData.points\r\n      .map((c,i) => ({...pointHandle({cx: c[0], cy: c[1]}), index: i}))\r\n\r\n    const updatePoint = (index) => {      \r\n      connectorData.points[index][0] += event.dx\r\n      connectorData.points[index][1] += event.dy\r\n      type.redrawConnector()\r\n    }\r\n  \r\n    handles = type.mapHandles(cHandles\r\n      .map(h => ({ ...h.move, drag: updatePoint.bind(type, h.index)})))\r\n\r\n  }\r\n\r\n  let data = lineSetup({ type, subjectType })\r\n  data = [data[0], ...connectorData.points, data[1]]\r\n  const components = [lineBuilder({ data, curve: connectorData.curve, className: \"connector\" })]\r\n\r\n  return { components , handles }\r\n}\r\n\r\nconst createPoints = function ( offset, anchors=2) {\r\n  const diff = { x: offset.x/(anchors + 1), y: offset.y/(anchors + 1) }\r\n  const p = []\r\n\r\n  let i = 1 \r\n  for (; i <= anchors; i++) {\r\n    p.push([diff.x*i + i%2*20, diff.y*i - i%2*20])\r\n  }\r\n  return p\r\n}","import { lineBuilder } from \"../Builder\"\r\n\r\nexport default ({ annotation, start, end, scale = 1 }) => {\r\n  const offset = annotation.position\r\n  if (!start) {\r\n    start = [annotation.dx, annotation.dy]\r\n  } else {\r\n    start = [-end[0] + start[0], -end[1] + start[1]]\r\n  }\r\n  if (!end) {\r\n    end = [annotation.x - offset.x, annotation.y - offset.y]\r\n  }\r\n\r\n  let x1 = end[0],\r\n    y1 = end[1]\r\n\r\n  let dx = start[0]\r\n  let dy = start[1]\r\n\r\n  let size = 10 * scale\r\n  let angleOffset = 16 / 180 * Math.PI\r\n  let angle = Math.atan(dy / dx)\r\n\r\n  if (dx < 0) {\r\n    angle += Math.PI\r\n  }\r\n\r\n  const data = [\r\n    [x1, y1],\r\n    [\r\n      Math.cos(angle + angleOffset) * size + x1,\r\n      Math.sin(angle + angleOffset) * size + y1\r\n    ],\r\n    [\r\n      Math.cos(angle - angleOffset) * size + x1,\r\n      Math.sin(angle - angleOffset) * size + y1\r\n    ],\r\n    [x1, y1]\r\n  ]\r\n\r\n  //TODO add in reverse\r\n  // if (canvasContext.arrowReverse){\r\n  //   data = [[x1, y1],\r\n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\r\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\r\n  //   [x1, y1]\r\n  //   ]\r\n  // } else {\r\n  //   data = [[x1, y1],\r\n  //   [Math.cos(angle + angleOffset)*size, Math.sin(angle + angleOffset)*size],\r\n  //   [Math.cos(angle - angleOffset)*size, Math.sin(angle - angleOffset)*size],\r\n  //   [x1, y1]\r\n  //   ]\r\n  // }\r\n\r\n  return {\r\n    components: [\r\n      lineBuilder({\r\n        data,\r\n        className: \"connector-end connector-arrow\",\r\n        classID: \"connector-end\"\r\n      })\r\n    ]\r\n  }\r\n}\r\n","import { arcBuilder } from \"../Builder\"\r\n\r\nexport default ({ line, scale = 1 }) => {\r\n  let dot = arcBuilder({\r\n    className: \"connector-end connector-dot\",\r\n    classID: \"connector-end\",\r\n    data: { radius: 3 * Math.sqrt(scale) }\r\n  })\r\n  dot.attrs.transform = `translate(${line.data[0][0]}, ${line.data[0][1]})`\r\n\r\n  return { components: [dot] }\r\n}\r\n","import { circleHandles } from \"../Handles\"\r\nimport { arcBuilder } from \"../Builder\"\r\nimport { event } from \"d3-selection\"\r\n\r\nexport default ({ subjectData, type }) => {\r\n  if (!subjectData.radius && !subjectData.outerRadius) {\r\n    subjectData.radius = 20\r\n  }\r\n\r\n  let handles = []\r\n  const c = arcBuilder({ data: subjectData, className: \"subject\" })\r\n  if (type.editMode) {\r\n    const h = circleHandles({\r\n      r1: c.data.outerRadius || c.data.radius,\r\n      r2: c.data.innerRadius,\r\n      padding: subjectData.radiusPadding\r\n    })\r\n\r\n    const updateRadius = attr => {\r\n      const r = subjectData[attr] + event.dx * Math.sqrt(2)\r\n      subjectData[attr] = r\r\n      type.redrawSubject()\r\n      type.redrawConnector()\r\n    }\r\n\r\n    const cHandles = [\r\n      {\r\n        ...h.r1,\r\n        drag: updateRadius.bind(\r\n          type,\r\n          subjectData.outerRadius !== undefined ? \"outerRadius\" : \"radius\"\r\n        )\r\n      }\r\n    ]\r\n\r\n    if (subjectData.innerRadius) {\r\n      cHandles.push({ ...h.r2, drag: updateRadius.bind(type, \"innerRadius\") })\r\n    }\r\n    handles = type.mapHandles(cHandles)\r\n  }\r\n\r\n  c.attrs[\"fill-opacity\"] = 0\r\n\r\n  return { components: [c], handles }\r\n}\r\n","import { lineBuilder } from \"../Builder\"\r\nimport { event } from \"d3-selection\"\r\n\r\nexport default ({ subjectData, type }) => {\r\n  if (!subjectData.width) {\r\n    subjectData.width = 100\r\n  }\r\n  if (!subjectData.height) {\r\n    subjectData.height = 100\r\n  }\r\n\r\n  let handles = []\r\n  let { width, height } = subjectData\r\n\r\n  const data = [[0, 0], [width, 0], [width, height], [0, height], [0, 0]]\r\n  let rect = lineBuilder({ data, className: \"subject\" })\r\n\r\n  if (type.editMode) {\r\n    const updateWidth = () => {\r\n      subjectData.width = event.x\r\n      type.redrawSubject()\r\n      type.redrawConnector()\r\n    }\r\n\r\n    const updateHeight = () => {\r\n      subjectData.height = event.y\r\n      type.redrawSubject()\r\n      type.redrawConnector()\r\n    }\r\n\r\n    const rHandles = [\r\n      { x: width, y: height / 2, drag: updateWidth.bind(type) },\r\n      { x: width / 2, y: height, drag: updateHeight.bind(type) }\r\n    ]\r\n\r\n    handles = type.mapHandles(rHandles)\r\n  }\r\n  rect.attrs[\"fill-opacity\"] = 0.1\r\n  return { components: [rect], handles }\r\n}\r\n","import { lineBuilder } from '../Builder'\r\n\r\n\r\nexport default ({ subjectData, type }) => {\r\n  const offset = type.annotation.position\r\n\r\n  let x1 = (subjectData.x1 !== undefined ? subjectData.x1 : offset.x) - offset.x,\r\n    x2 = (subjectData.x2 !== undefined ? subjectData.x2 : offset.x) - offset.x,\r\n    y1 = (subjectData.y1 !== undefined ? subjectData.y1 : offset.y) - offset.y,\r\n    y2 = (subjectData.y2 !== undefined ? subjectData.y2 : offset.y) - offset.y\r\n\r\n  const data = [[x1, y1], [x2, y2]]\r\n  return { components: [lineBuilder({ data, className : 'subject'})]}\r\n}","import { lineBuilder, arcBuilder } from \"../Builder\"\r\nimport { event } from \"d3-selection\"\r\n\r\nexport default ({ subjectData = {}, type = {} }, annotation = {}) => {\r\n  const typeSettings = type.typeSettings && type.typeSettings.subject\r\n\r\n  if (!subjectData.radius) {\r\n    if (typeSettings && typeSettings.radius) {\r\n      subjectData.radius = typeSettings.radius\r\n    } else {\r\n      subjectData.radius = 14\r\n    }\r\n  }\r\n  if (!subjectData.x) {\r\n    if (typeSettings && typeSettings.x) {\r\n      subjectData.x = typeSettings.x\r\n    }\r\n  }\r\n  if (!subjectData.y) {\r\n    if (typeSettings && typeSettings.y) {\r\n      subjectData.y = typeSettings.y\r\n    }\r\n  }\r\n\r\n  let handles = []\r\n  const components = []\r\n  const radius = subjectData.radius\r\n  const innerRadius = radius * 0.7\r\n  let x = 0\r\n  let y = 0\r\n\r\n  const notCornerOffset = Math.sqrt(2) * radius\r\n  const placement = {\r\n    xleftcorner: -radius,\r\n    xrightcorner: radius,\r\n    ytopcorner: -radius,\r\n    ybottomcorner: radius,\r\n    xleft: -notCornerOffset,\r\n    xright: notCornerOffset,\r\n    ytop: -notCornerOffset,\r\n    ybottom: notCornerOffset\r\n  }\r\n\r\n  if (subjectData.x && !subjectData.y) {\r\n    x = placement[`x${subjectData.x}`]\r\n  } else if (subjectData.y && !subjectData.x) {\r\n    y = placement[`y${subjectData.y}`]\r\n  } else if (subjectData.x && subjectData.y) {\r\n    x = placement[`x${subjectData.x}corner`]\r\n    y = placement[`y${subjectData.y}corner`]\r\n  }\r\n\r\n  const transform = `translate(${x}, ${y})`\r\n  const circlebg = arcBuilder({ className: \"subject\", data: { radius } })\r\n  circlebg.attrs.transform = transform\r\n  circlebg.attrs.fill = annotation.color\r\n  circlebg.attrs[\"stroke-linecap\"] = \"round\"\r\n  circlebg.attrs[\"stroke-width\"] = \"3px\"\r\n\r\n  const circle = arcBuilder({\r\n    className: \"subject-ring\",\r\n    data: { outerRadius: radius, innerRadius }\r\n  })\r\n\r\n  circle.attrs.transform = transform\r\n  // circle.attrs.fill = annotation.color\r\n  circle.attrs[\"stroke-width\"] = \"3px\"\r\n  circle.attrs.fill = \"white\"\r\n\r\n  let pointer\r\n  if (x && y || !x && !y) {\r\n    pointer = lineBuilder({\r\n      className: \"subject-pointer\",\r\n      data: [[0, 0], [x || 0, 0], [0, y || 0], [0, 0]]\r\n    })\r\n  } else if (x || y) {\r\n    const notCornerPointerXY = (v, sign = 1) =>\r\n      v && v / Math.sqrt(2) / Math.sqrt(2) || sign * radius / Math.sqrt(2)\r\n\r\n    pointer = lineBuilder({\r\n      className: \"subject-pointer\",\r\n      data: [\r\n        [0, 0],\r\n        [notCornerPointerXY(x), notCornerPointerXY(y)],\r\n        [notCornerPointerXY(x, -1), notCornerPointerXY(y, -1)],\r\n        [0, 0]\r\n      ]\r\n    })\r\n  }\r\n\r\n  if (pointer) {\r\n    pointer.attrs.fill = annotation.color\r\n    pointer.attrs[\"stroke-linecap\"] = \"round\"\r\n    pointer.attrs[\"stroke-width\"] = \"3px\"\r\n    components.push(pointer)\r\n  }\r\n\r\n  if (type.editMode) {\r\n    const dragBadge = () => {\r\n      subjectData.x =\r\n        event.x < -radius * 2\r\n          ? \"left\"\r\n          : event.x > radius * 2 ? \"right\" : undefined\r\n      subjectData.y =\r\n        event.y < -radius * 2\r\n          ? \"top\"\r\n          : event.y > radius * 2 ? \"bottom\" : undefined\r\n\r\n      type.redrawSubject()\r\n    }\r\n\r\n    const bHandles = { x: x * 2, y: y * 2, drag: dragBadge.bind(type) }\r\n    if (!bHandles.x && !bHandles.y) {\r\n      bHandles.y = -radius\r\n    }\r\n\r\n    handles = type.mapHandles([bHandles])\r\n  }\r\n\r\n  let text\r\n  if (subjectData.text) {\r\n    text = {\r\n      type: \"text\",\r\n      className: \"badge-text\",\r\n      attrs: {\r\n        fill: \"white\",\r\n        stroke: \"none\",\r\n        \"font-size\": \".7em\",\r\n        text: subjectData.text,\r\n        \"text-anchor\": \"middle\",\r\n        dy: \".25em\",\r\n        x,\r\n        y\r\n      }\r\n    }\r\n  }\r\n\r\n  components.push(circlebg)\r\n  components.push(circle)\r\n  components.push(text)\r\n\r\n  return { components, handles }\r\n}\r\n","import { select, event } from \"d3-selection\"\r\nimport { drag } from \"d3-drag\"\r\nimport { addHandles } from \"./Handles\"\r\n\r\n//Note options\r\nimport noteAlignment from \"./Note/alignment\"\r\nimport noteVertical from \"./Note/lineType-vertical\"\r\nimport noteHorizontal from \"./Note/lineType-horizontal\"\r\n\r\n//Connector options\r\nimport connectorLine from \"./Connector/type-line\"\r\nimport connectorElbow from \"./Connector/type-elbow\"\r\nimport connectorCurve from \"./Connector/type-curve\"\r\nimport connectorArrow from \"./Connector/end-arrow\"\r\nimport connectorDot from \"./Connector/end-dot\"\r\n\r\n//Subject options\r\nimport subjectCircle from \"./Subject/circle\"\r\nimport subjectRect from \"./Subject/rect\"\r\nimport subjectThreshold from \"./Subject/threshold\"\r\nimport subjectBadge from \"./Subject/badge\"\r\n\r\nexport class Type {\r\n  constructor({ a, annotation, editMode, dispatcher, notePadding, accessors }) {\r\n    this.a = a\r\n\r\n    this.note =\r\n      annotation.disable.indexOf(\"note\") === -1 && a.select(\"g.annotation-note\")\r\n    this.noteContent = this.note && a.select(\"g.annotation-note-content\")\r\n    this.connector =\r\n      annotation.disable.indexOf(\"connector\") === -1 &&\r\n      a.select(\"g.annotation-connector\")\r\n    this.subject =\r\n      annotation.disable.indexOf(\"subject\") === -1 &&\r\n      a.select(\"g.annotation-subject\")\r\n    this.dispatcher = dispatcher\r\n\r\n    if (dispatcher) {\r\n      const handler = addHandlers.bind(null, dispatcher, annotation)\r\n      handler({ component: this.note, name: \"note\" })\r\n      handler({ component: this.connector, name: \"connector\" })\r\n      handler({ component: this.subject, name: \"subject\" })\r\n    }\r\n\r\n    this.annotation = annotation\r\n    this.editMode = annotation.editMode || editMode\r\n    this.notePadding = notePadding !== undefined ? notePadding : 3\r\n    this.offsetCornerX = 0\r\n    this.offsetCornerY = 0\r\n\r\n    if (accessors && annotation.data) {\r\n      this.init(accessors)\r\n    }\r\n  }\r\n\r\n  init(accessors) {\r\n    if (!this.annotation.x) {\r\n      this.mapX(accessors)\r\n    }\r\n    if (!this.annotation.y) {\r\n      this.mapY(accessors)\r\n    }\r\n  }\r\n\r\n  mapY(accessors) {\r\n    if (accessors.y) {\r\n      this.annotation.y = accessors.y(this.annotation.data)\r\n    }\r\n  }\r\n\r\n  mapX(accessors) {\r\n    if (accessors.x) {\r\n      this.annotation.x = accessors.x(this.annotation.data)\r\n    }\r\n  }\r\n\r\n  updateEditMode() {\r\n    this.a.selectAll(\"circle.handle\").remove()\r\n  }\r\n\r\n  drawOnSVG(component, builders) {\r\n    if (!Array.isArray(builders)) {\r\n      builders = [builders]\r\n    }\r\n\r\n    builders\r\n      .filter(b => b)\r\n      .forEach(({ type, className, attrs, handles, classID }) => {\r\n        if (type === \"handle\") {\r\n          addHandles({ group: component, r: attrs && attrs.r, handles })\r\n        } else {\r\n          newWithClass(component, [this.annotation], type, className, classID)\r\n          const el = component.select(`${type}.${classID || className}`)\r\n          const addAttrs = Object.keys(attrs)\r\n          const removeAttrs = []\r\n\r\n          const currentAttrs = el.node().attributes\r\n          for (let i = currentAttrs.length - 1; i >= 0; i--) {\r\n            const name = currentAttrs[i].name\r\n            if (addAttrs.indexOf(name) === -1 && name !== \"class\")\r\n              removeAttrs.push(name)\r\n          }\r\n\r\n          addAttrs.forEach(attr => {\r\n            if (attr === \"text\") {\r\n              el.text(attrs[attr])\r\n            } else {\r\n              el.attr(attr, attrs[attr])\r\n            }\r\n          })\r\n\r\n          removeAttrs.forEach(attr => el.attr(attr, null))\r\n        }\r\n      })\r\n  }\r\n\r\n  //TODO: how to extend this to a drawOnCanvas mode?\r\n\r\n  getNoteBBox() {\r\n    return bboxWithoutHandles(this.note, \".annotation-note-content text\")\r\n  }\r\n  getNoteBBoxOffset() {\r\n    const bbox = bboxWithoutHandles(this.note, \".annotation-note-content\")\r\n    const transform = this.noteContent.attr(\"transform\").split(/\\(|\\,|\\)/g)\r\n    bbox.offsetCornerX = parseFloat(transform[1]) + this.annotation.dx\r\n    bbox.offsetCornerY = parseFloat(transform[2]) + this.annotation.dy\r\n    bbox.offsetX = this.annotation.dx\r\n    bbox.offsetY = this.annotation.dy\r\n    return bbox\r\n  }\r\n\r\n  drawSubject(context = {}) {\r\n    const subjectData = this.annotation.subject\r\n    const type = context.type\r\n    const subjectParams = { type: this, subjectData }\r\n\r\n    let subject = {}\r\n    if (type === \"circle\") subject = subjectCircle(subjectParams)\r\n    else if (type === \"rect\") subject = subjectRect(subjectParams)\r\n    else if (type === \"threshold\") subject = subjectThreshold(subjectParams)\r\n    else if (type === \"badge\")\r\n      subject = subjectBadge(subjectParams, this.annotation)\r\n\r\n    let { components = [], handles = [] } = subject\r\n    components.forEach(c => {\r\n      if (c && c.attrs && !c.attrs.stroke) {\r\n        c.attrs.stroke = this.annotation.color\r\n      }\r\n    })\r\n\r\n    if (this.editMode) {\r\n      handles = handles.concat(\r\n        this.mapHandles([{ drag: this.dragSubject.bind(this) }])\r\n      )\r\n      components.push({ type: \"handle\", handles })\r\n    }\r\n\r\n    return components\r\n  }\r\n\r\n  drawConnector(context = {}) {\r\n    const connectorData = this.annotation.connector\r\n    const type = connectorData.type || context.type\r\n    const connectorParams = { type: this, connectorData }\r\n    connectorParams.subjectType =\r\n      this.typeSettings &&\r\n      this.typeSettings.subject &&\r\n      this.typeSettings.subject.type\r\n\r\n    let connector = {}\r\n    if (type === \"curve\") connector = connectorCurve(connectorParams)\r\n    else if (type === \"elbow\") connector = connectorElbow(connectorParams)\r\n    else connector = connectorLine(connectorParams)\r\n    let { components = [], handles = [] } = connector\r\n    const line = components[0]\r\n    //TODO: genericize this into fill t/f stroke t/f\r\n    if (line) {\r\n      line.attrs.stroke = this.annotation.color\r\n      line.attrs.fill = \"none\"\r\n    }\r\n    const endType = connectorData.end || context.end\r\n    let end = {}\r\n    if (endType === \"arrow\") {\r\n      let s = line.data[1]\r\n      const e = line.data[0]\r\n      const distance = Math.sqrt(\r\n        Math.pow(s[0] - e[0], 2) + Math.pow(s[1] - e[1], 2)\r\n      )\r\n      if (distance < 5 && line.data[2]) {\r\n        s = line.data[2]\r\n      }\r\n      end = connectorArrow({\r\n        annotation: this.annotation,\r\n        start: s,\r\n        end: e,\r\n        scale: connectorData.endScale\r\n      })\r\n    } else if (endType === \"dot\") {\r\n      end = connectorDot({ line, scale: connectorData.endScale })\r\n    } else if (!endType || endType === \"none\") {\r\n      this.connector && this.connector.select(\".connector-end\").remove()\r\n    }\r\n\r\n    if (end.components) {\r\n      end.components.forEach(c => {\r\n        c.attrs.fill = this.annotation.color\r\n        c.attrs.stroke = this.annotation.color\r\n      })\r\n      components = components.concat(end.components)\r\n    }\r\n\r\n    if (this.editMode) {\r\n      if (handles.length !== 0) components.push({ type: \"handle\", handles })\r\n    }\r\n    return components\r\n  }\r\n\r\n  drawNote(context = {}) {\r\n    const noteData = this.annotation.note\r\n    const align = noteData.align || context.align || \"dynamic\"\r\n    const noteParams = {\r\n      bbox: context.bbox,\r\n      align,\r\n      offset: this.annotation.offset\r\n    }\r\n    const lineType = noteData.lineType || context.lineType\r\n    let note = {}\r\n    if (lineType === \"vertical\") note = noteVertical(noteParams)\r\n    else if (lineType === \"horizontal\") note = noteHorizontal(noteParams)\r\n\r\n    let { components = [], handles = [] } = note\r\n    components.forEach(c => {\r\n      c.attrs.stroke = this.annotation.color\r\n    })\r\n\r\n    if (this.editMode) {\r\n      handles = this.mapHandles([\r\n        { x: 0, y: 0, drag: this.dragNote.bind(this) }\r\n      ])\r\n      components.push({ type: \"handle\", handles })\r\n\r\n      const dragging = this.dragNote.bind(this),\r\n        start = this.dragstarted.bind(this),\r\n        end = this.dragended.bind(this)\r\n      this.note.call(\r\n        drag()\r\n          .container(select(\"g.annotations\").node())\r\n          .on(\"start\", d => start(d))\r\n          .on(\"drag\", d => dragging(d))\r\n          .on(\"end\", d => end(d))\r\n      )\r\n    } else {\r\n      this.note.on(\"mousedown.drag\", null)\r\n    }\r\n    return components\r\n  }\r\n\r\n  drawNoteContent(context) {\r\n    const noteData = this.annotation.note\r\n    const padding =\r\n      noteData.padding !== undefined ? noteData.padding : this.notePadding\r\n    let orientation = noteData.orientation || context.orientation || \"topBottom\"\r\n    const lineType = noteData.lineType || context.lineType\r\n    const align = noteData.align || context.align || \"dynamic\"\r\n\r\n    if (lineType === \"vertical\") orientation = \"leftRight\"\r\n    else if (lineType === \"horizontal\") orientation = \"topBottom\"\r\n\r\n    const noteParams = {\r\n      padding,\r\n      bbox: context.bbox,\r\n      offset: this.annotation.offset,\r\n      orientation,\r\n      align\r\n    }\r\n    const { x, y } = noteAlignment(noteParams)\r\n    this.offsetCornerX = x + this.annotation.dx\r\n    this.offsetCornerY = y + this.annotation.dy\r\n    this.note && this.noteContent.attr(\"transform\", `translate(${x}, ${y})`)\r\n\r\n    return []\r\n  }\r\n\r\n  drawOnScreen(component, drawFunction) {\r\n    return this.drawOnSVG(component, drawFunction)\r\n  }\r\n\r\n  redrawSubject() {\r\n    this.subject && this.drawOnScreen(this.subject, this.drawSubject())\r\n  }\r\n\r\n  redrawConnector() {\r\n    this.connector && this.drawOnScreen(this.connector, this.drawConnector())\r\n  }\r\n\r\n  redrawNote(bbox = this.getNoteBBox()) {\r\n    this.noteContent &&\r\n      this.drawOnScreen(this.noteContent, this.drawNoteContent({ bbox }))\r\n    this.note && this.drawOnScreen(this.note, this.drawNote({ bbox }))\r\n  }\r\n\r\n  setPosition() {\r\n    const position = this.annotation.position\r\n    this.a.attr(\"transform\", `translate(${position.x}, ${position.y})`)\r\n  }\r\n\r\n  clearComponents() {\r\n    this.subject && this.subject.select(\"*\").remove()\r\n    this.connector && this.connector.select(\"*\").remove()\r\n    // this.note && this.note.select(\"*\").remove()\r\n  }\r\n\r\n  setOffset() {\r\n    if (this.note) {\r\n      const offset = this.annotation.offset\r\n      this.note.attr(\"transform\", `translate(${offset.x}, ${offset.y})`)\r\n    }\r\n  }\r\n\r\n  setPositionWithAccessors(accessors) {\r\n    if (accessors && this.annotation.data) {\r\n      this.mapX(accessors)\r\n      this.mapY(accessors)\r\n    }\r\n    this.setPosition()\r\n  }\r\n\r\n  setClassName() {\r\n    this.a.attr(\r\n      \"class\",\r\n      `annotation ${this.className && this.className()} ${\r\n        this.editMode ? \"editable\" : \"\"\r\n      } ${this.annotation.className || \"\"}`\r\n    )\r\n  }\r\n\r\n  draw() {\r\n    this.setClassName()\r\n    this.setPosition()\r\n    this.setOffset()\r\n    this.redrawSubject()\r\n    this.redrawConnector()\r\n    this.redrawNote()\r\n  }\r\n\r\n  dragstarted() {\r\n    event.sourceEvent.stopPropagation()\r\n    this.dispatcher &&\r\n      this.dispatcher.call(\"dragstart\", this.a, this.annotation)\r\n    this.a.classed(\"dragging\", true)\r\n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"none\")\r\n  }\r\n  dragended() {\r\n    this.dispatcher && this.dispatcher.call(\"dragend\", this.a, this.annotation)\r\n    this.a.classed(\"dragging\", false)\r\n    this.a.selectAll(\"circle.handle\").style(\"pointer-events\", \"all\")\r\n  }\r\n\r\n  dragSubject() {\r\n    const position = this.annotation.position\r\n    position.x += event.dx\r\n    position.y += event.dy\r\n    this.annotation.position = position\r\n  }\r\n\r\n  dragNote() {\r\n    const offset = this.annotation.offset\r\n    offset.x += event.dx\r\n    offset.y += event.dy\r\n    this.annotation.offset = offset\r\n  }\r\n\r\n  mapHandles(handles) {\r\n    return handles.map(h => ({\r\n      ...h,\r\n      start: this.dragstarted.bind(this),\r\n      end: this.dragended.bind(this)\r\n    }))\r\n  }\r\n}\r\n\r\nexport const customType = (initialType, typeSettings, init) => {\r\n  return class customType extends initialType {\r\n    constructor(settings) {\r\n      super(settings)\r\n      this.typeSettings = typeSettings\r\n\r\n      if (typeSettings.disable) {\r\n        typeSettings.disable.forEach(d => {\r\n          this[d] && this[d].remove()\r\n\r\n          this[d] = undefined\r\n          if (d === \"note\") {\r\n            this.noteContent = undefined\r\n          }\r\n        })\r\n      }\r\n    }\r\n\r\n    static init(annotation, accessors) {\r\n      super.init(annotation, accessors)\r\n      if (init) {\r\n        annotation = init(annotation, accessors)\r\n      }\r\n      return annotation\r\n    }\r\n\r\n    className() {\r\n      return `${typeSettings.className ||\r\n        super.className && super.className() ||\r\n        \"\"}`\r\n    }\r\n\r\n    drawSubject(context) {\r\n      this.typeSettings.subject = Object.assign(\r\n        {},\r\n        typeSettings.subject,\r\n        this.typeSettings.subject\r\n      )\r\n      return super.drawSubject({ ...context, ...this.typeSettings.subject })\r\n    }\r\n\r\n    drawConnector(context) {\r\n      this.typeSettings.connector = Object.assign(\r\n        {},\r\n        typeSettings.connector,\r\n        this.typeSettings.connector\r\n      )\r\n      return super.drawConnector({\r\n        ...context,\r\n        ...typeSettings.connector,\r\n        ...this.typeSettings.connector\r\n      })\r\n    }\r\n\r\n    drawNote(context) {\r\n      this.typeSettings.note = Object.assign(\r\n        {},\r\n        typeSettings.note,\r\n        this.typeSettings.note\r\n      )\r\n      return super.drawNote({\r\n        ...context,\r\n        ...typeSettings.note,\r\n        ...this.typeSettings.note\r\n      })\r\n    }\r\n\r\n    drawNoteContent(context) {\r\n      return super.drawNoteContent({\r\n        ...context,\r\n        ...typeSettings.note,\r\n        ...this.typeSettings.note\r\n      })\r\n    }\r\n  }\r\n}\r\n\r\nexport class d3NoteText extends Type {\r\n  constructor(params) {\r\n    super(params)\r\n    this.textWrap = params.textWrap || 120\r\n    this.drawText()\r\n  }\r\n\r\n  updateTextWrap(textWrap) {\r\n    this.textWrap = textWrap\r\n    this.drawText()\r\n  }\r\n\r\n  //TODO: add update text functionality\r\n\r\n  drawText() {\r\n    if (this.note) {\r\n      newWithClass(this.note, [this.annotation], \"g\", \"annotation-note-content\")\r\n\r\n      const noteContent = this.note.select(\"g.annotation-note-content\")\r\n      newWithClass(noteContent, [this.annotation], \"rect\", \"annotation-note-bg\")\r\n      newWithClass(\r\n        noteContent,\r\n        [this.annotation],\r\n        \"text\",\r\n        \"annotation-note-label\"\r\n      )\r\n      newWithClass(\r\n        noteContent,\r\n        [this.annotation],\r\n        \"text\",\r\n        \"annotation-note-title\"\r\n      )\r\n\r\n      let titleBBox = { height: 0 }\r\n      const label = this.a.select(\"text.annotation-note-label\")\r\n      const wrapLength =\r\n        this.annotation.note && this.annotation.note.wrap ||\r\n        this.typeSettings &&\r\n          this.typeSettings.note &&\r\n          this.typeSettings.note.wrap ||\r\n        this.textWrap\r\n\r\n      const wrapSplitter =\r\n        this.annotation.note && this.annotation.note.wrapSplitter ||\r\n        this.typeSettings &&\r\n          this.typeSettings.note &&\r\n          this.typeSettings.note.wrapSplitter\r\n\r\n      let bgPadding =\r\n        this.annotation.note && this.annotation.note.bgPadding ||\r\n        this.typeSettings &&\r\n          this.typeSettings.note &&\r\n          this.typeSettings.note.bgPadding\r\n\r\n      let bgPaddingFinal = { top: 0, bottom: 0, left: 0, right: 0 }\r\n      if (typeof bgPadding === \"number\") {\r\n        bgPaddingFinal = {\r\n          top: bgPadding,\r\n          bottom: bgPadding,\r\n          left: bgPadding,\r\n          right: bgPadding\r\n        }\r\n      } else if (bgPadding && typeof bgPadding === \"object\") {\r\n        bgPaddingFinal = Object.assign(bgPaddingFinal, bgPadding)\r\n      }\r\n\r\n      if (this.annotation.note.title) {\r\n        const title = this.a.select(\"text.annotation-note-title\")\r\n        title.text(this.annotation.note.title)\r\n        title.attr(\"fill\", this.annotation.color)\r\n        title.attr(\"font-weight\", \"bold\")\r\n        title.call(wrap, wrapLength, wrapSplitter)\r\n        titleBBox = title.node().getBBox()\r\n      }\r\n\r\n      label.text(this.annotation.note.label).attr(\"dx\", \"0\")\r\n      label.call(wrap, wrapLength, wrapSplitter)\r\n\r\n      label.attr(\"y\", titleBBox.height * 1.1 || 0)\r\n      label.attr(\"fill\", this.annotation.color)\r\n\r\n      const bbox = this.getNoteBBox()\r\n\r\n      this.a\r\n        .select(\"rect.annotation-note-bg\")\r\n        .attr(\"width\", bbox.width + bgPaddingFinal.left + bgPaddingFinal.right)\r\n        .attr(\r\n          \"height\",\r\n          bbox.height + bgPaddingFinal.top + bgPaddingFinal.bottom\r\n        )\r\n        .attr(\"x\", bbox.x - bgPaddingFinal.left)\r\n        .attr(\"y\", -bgPaddingFinal.top)\r\n        .attr(\"fill\", \"white\")\r\n        .attr(\"fill-opacity\", 0)\r\n    }\r\n  }\r\n}\r\n\r\nexport const d3Label = customType(d3NoteText, {\r\n  className: \"label\",\r\n  note: { align: \"middle\" }\r\n})\r\n\r\nexport const d3Callout = customType(d3NoteText, {\r\n  className: \"callout\",\r\n  note: { lineType: \"horizontal\" }\r\n})\r\n\r\nexport const d3CalloutElbow = customType(d3Callout, {\r\n  className: \"callout elbow\",\r\n  connector: { type: \"elbow\" }\r\n})\r\n\r\nexport const d3CalloutCurve = customType(d3Callout, {\r\n  className: \"callout curve\",\r\n  connector: { type: \"curve\" }\r\n})\r\n\r\nexport const d3Badge = customType(Type, {\r\n  className: \"badge\",\r\n  subject: { type: \"badge\" },\r\n  disable: [\"connector\", \"note\"]\r\n})\r\n\r\nexport const d3CalloutCircle = customType(d3NoteText, {\r\n  className: \"callout circle\",\r\n  subject: { type: \"circle\" },\r\n  note: { lineType: \"horizontal\" },\r\n  connector: { type: \"elbow\" }\r\n})\r\n\r\nexport const d3CalloutRect = customType(d3NoteText, {\r\n  className: \"callout rect\",\r\n  subject: { type: \"rect\" },\r\n  note: { lineType: \"horizontal\" },\r\n  connector: { type: \"elbow\" }\r\n})\r\n\r\nclass ThresholdMap extends d3Callout {\r\n  mapY(accessors) {\r\n    super.mapY(accessors)\r\n    const a = this.annotation\r\n    if ((a.subject.x1 || a.subject.x2) && a.data && accessors.y) {\r\n      a.y = accessors.y(a.data)\r\n    }\r\n    if ((a.subject.x1 || a.subject.x2) && !a.x) {\r\n      a.x = a.subject.x1 || a.subject.x2\r\n    }\r\n  }\r\n\r\n  mapX(accessors) {\r\n    super.mapX(accessors)\r\n    const a = this.annotation\r\n    if ((a.subject.y1 || a.subject.y2) && a.data && accessors.x) {\r\n      a.x = accessors.x(a.data)\r\n    }\r\n    if ((a.subject.y1 || a.subject.y2) && !a.y) {\r\n      a.y = a.subject.y1 || a.subject.y2\r\n    }\r\n  }\r\n}\r\n\r\nexport const d3XYThreshold = customType(ThresholdMap, {\r\n  className: \"callout xythreshold\",\r\n  subject: { type: \"threshold\" }\r\n})\r\n\r\nexport const newWithClass = (a, d, type, className, classID) => {\r\n  const group = a.selectAll(`${type}.${classID || className}`).data(d)\r\n  group\r\n    .enter()\r\n    .append(type)\r\n    .merge(group)\r\n    .attr(\"class\", className)\r\n\r\n  group.exit().remove()\r\n  return a\r\n}\r\n\r\nconst addHandlers = (dispatcher, annotation, { component, name }) => {\r\n  if (component) {\r\n    component\r\n      .on(\"mouseover.annotations\", () => {\r\n        dispatcher.call(`${name}over`, component, annotation)\r\n      })\r\n      .on(\"mouseout.annotations\", () =>\r\n        dispatcher.call(`${name}out`, component, annotation)\r\n      )\r\n      .on(\"click.annotations\", () =>\r\n        dispatcher.call(`${name}click`, component, annotation)\r\n      )\r\n  }\r\n}\r\n\r\n//Text wrapping code adapted from Mike Bostock\r\nconst wrap = (text, width, wrapSplitter, lineHeight = 1.2) => {\r\n  text.each(function() {\r\n    const text = select(this),\r\n      words = text\r\n        .text()\r\n        .split(wrapSplitter || /[ \\t\\r\\n]+/)\r\n        .reverse()\r\n        .filter(w => w !== \"\")\r\n    let word,\r\n      line = [],\r\n      tspan = text\r\n        .text(null)\r\n        .append(\"tspan\")\r\n        .attr(\"x\", 0)\r\n        .attr(\"dy\", 0.8 + \"em\")\r\n\r\n    while (word = words.pop()) {\r\n      line.push(word)\r\n      tspan.text(line.join(\" \"))\r\n      if (tspan.node().getComputedTextLength() > width && line.length > 1) {\r\n        line.pop()\r\n        tspan.text(line.join(\" \"))\r\n        line = [word]\r\n        tspan = text\r\n          .append(\"tspan\")\r\n          .attr(\"x\", 0)\r\n          .attr(\"dy\", lineHeight + \"em\")\r\n          .text(word)\r\n      }\r\n    }\r\n  })\r\n}\r\n\r\nconst bboxWithoutHandles = (selection, selector = \":not(.handle)\") => {\r\n  if (!selection) {\r\n    return { x: 0, y: 0, width: 0, height: 0 }\r\n  }\r\n\r\n  return selection\r\n    .selectAll(selector)\r\n    .nodes()\r\n    .reduce(\r\n      (p, c) => {\r\n        const bbox = c.getBBox()\r\n        p.x = Math.min(p.x, bbox.x)\r\n        p.y = Math.min(p.y, bbox.y)\r\n        p.width = Math.max(p.width, bbox.width)\r\n\r\n        const yOffset = c && c.attributes && c.attributes.y\r\n        p.height = Math.max(\r\n          p.height,\r\n          (yOffset && parseFloat(yOffset.value) || 0) + bbox.height\r\n        )\r\n        return p\r\n      },\r\n      { x: 0, y: 0, width: 0, height: 0 }\r\n    )\r\n}\r\n\r\nexport default {\r\n  Type,\r\n  d3Label,\r\n  d3Callout,\r\n  d3CalloutElbow,\r\n  d3CalloutCurve,\r\n  d3CalloutCircle,\r\n  d3CalloutRect,\r\n  d3XYThreshold,\r\n  d3Badge,\r\n  customType\r\n}\r\n","import Annotation from \"./Annotation\"\r\nimport AnnotationCollection from \"./AnnotationCollection\"\r\nimport { newWithClass, d3Callout } from \"./Types-d3\"\r\nimport { select } from \"d3-selection\"\r\nimport { dispatch } from \"d3-dispatch\"\r\n\r\nexport default function annotation() {\r\n  let annotations = [],\r\n    collection,\r\n    context, //TODO: add canvas functionality\r\n    disable = [],\r\n    accessors = {},\r\n    accessorsInverse = {},\r\n    editMode = false,\r\n    ids,\r\n    type = d3Callout,\r\n    textWrap,\r\n    notePadding,\r\n    annotationDispatcher = dispatch(\r\n      \"subjectover\",\r\n      \"subjectout\",\r\n      \"subjectclick\",\r\n      \"connectorover\",\r\n      \"connectorout\",\r\n      \"connectorclick\",\r\n      \"noteover\",\r\n      \"noteout\",\r\n      \"noteclick\",\r\n      \"dragend\",\r\n      \"dragstart\"\r\n    ),\r\n    sel\r\n\r\n  const annotation = function(selection) {\r\n    sel = selection\r\n    //TODO: check to see if this is still needed\r\n    if (!editMode) {\r\n      selection.selectAll(\"circle.handle\").remove()\r\n    }\r\n\r\n    const translatedAnnotations = annotations.map(a => {\r\n      if (!a.type) {\r\n        a.type = type\r\n      }\r\n      if (!a.disable) {\r\n        a.disable = disable\r\n      }\r\n      return new Annotation(a)\r\n    })\r\n\r\n    collection =\r\n      collection ||\r\n      new AnnotationCollection({\r\n        annotations: translatedAnnotations,\r\n        accessors,\r\n        accessorsInverse,\r\n        ids\r\n      })\r\n\r\n    const annotationG = selection.selectAll(\"g\").data([collection])\r\n    annotationG.enter().append(\"g\").attr(\"class\", `annotations`)\r\n\r\n    const group = selection.select(\"g.annotations\")\r\n    newWithClass(group, collection.annotations, \"g\", \"annotation\")\r\n\r\n    const annotation = group.selectAll(\"g.annotation\")\r\n\r\n    annotation.each(function(d) {\r\n      const a = select(this)\r\n\r\n      a.attr(\"class\", \"annotation\")\r\n\r\n      newWithClass(a, [d], \"g\", \"annotation-connector\")\r\n      newWithClass(a, [d], \"g\", \"annotation-subject\")\r\n      newWithClass(a, [d], \"g\", \"annotation-note\")\r\n      newWithClass(\r\n        a.select(\"g.annotation-note\"),\r\n        [d],\r\n        \"g\",\r\n        \"annotation-note-content\"\r\n      )\r\n      d.type =\r\n        d.type.toString() === \"[object Object]\"\r\n          ? d.type\r\n          : new d.type({\r\n            a,\r\n            annotation: d,\r\n            textWrap,\r\n            notePadding,\r\n            editMode,\r\n            dispatcher: annotationDispatcher,\r\n            accessors\r\n          })\r\n      d.type.draw()\r\n      d.type.drawText && d.type.drawText()\r\n    })\r\n  }\r\n\r\n  annotation.json = function() {\r\n    /* eslint-disable no-console */\r\n    console.log(\r\n      \"Annotations JSON was copied to your clipboard. Please note the annotation type is not JSON compatible. It appears in the objects array in the console, but not in the copied JSON.\",\r\n      collection.json\r\n    )\r\n    /* eslint-enable no-console */\r\n    window.copy(\r\n      JSON.stringify(\r\n        collection.json.map(a => {\r\n          delete a.type\r\n          return a\r\n        })\r\n      )\r\n    )\r\n    return annotation\r\n  }\r\n\r\n  annotation.update = function() {\r\n    if (annotations && collection) {\r\n      annotations = collection.annotations.map(a => {\r\n        a.type.draw()\r\n        return a\r\n      })\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.updateText = function() {\r\n    if (collection) {\r\n      collection.updateText(textWrap)\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.updatedAccessors = function() {\r\n    collection.setPositionWithAccessors()\r\n    annotations = collection.annotations\r\n    return annotation\r\n  }\r\n\r\n  annotation.disable = function(_) {\r\n    if (!arguments.length) return disable\r\n    disable = _\r\n    if (collection) {\r\n      collection.updateDisable(disable)\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.textWrap = function(_) {\r\n    if (!arguments.length) return textWrap\r\n    textWrap = _\r\n    if (collection) {\r\n      collection.updateTextWrap(textWrap)\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.notePadding = function(_) {\r\n    if (!arguments.length) return notePadding\r\n    notePadding = _\r\n    if (collection) {\r\n      collection.updateNotePadding(notePadding)\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n  //todo think of how to handle when undefined is sent\r\n  annotation.type = function(_, settings) {\r\n    if (!arguments.length) return type\r\n    type = _\r\n    if (collection) {\r\n      collection.annotations.map(a => {\r\n        a.type.note &&\r\n          a.type.note.selectAll(\"*:not(.annotation-note-content)\").remove()\r\n        a.type.noteContent && a.type.noteContent.selectAll(\"*\").remove()\r\n        a.type.subject && a.type.subject.selectAll(\"*\").remove()\r\n        a.type.connector && a.type.connector.selectAll(\"*\").remove()\r\n        a.type.typeSettings = {}\r\n        a.type = type\r\n\r\n        a.subject = settings && settings.subject || a.subject\r\n        a.connector = settings && settings.connector || a.connector\r\n        a.note = settings && settings.note || a.note\r\n      })\r\n\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.annotations = function(_) {\r\n    if (!arguments.length)\r\n      return collection && collection.annotations || annotations\r\n    annotations = _\r\n\r\n    if (collection && collection.annotations) {\r\n      const rerun = annotations.some(\r\n        d => !d.type || d.type.toString() !== \"[object Object]\"\r\n      )\r\n\r\n      if (rerun) {\r\n        collection = null\r\n        annotation(sel)\r\n      } else {\r\n        collection.annotations = annotations\r\n      }\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.context = function(_) {\r\n    if (!arguments.length) return context\r\n    context = _\r\n    return annotation\r\n  }\r\n\r\n  annotation.accessors = function(_) {\r\n    if (!arguments.length) return accessors\r\n    accessors = _\r\n    return annotation\r\n  }\r\n\r\n  annotation.accessorsInverse = function(_) {\r\n    if (!arguments.length) return accessorsInverse\r\n    accessorsInverse = _\r\n    return annotation\r\n  }\r\n\r\n  annotation.ids = function(_) {\r\n    if (!arguments.length) return ids\r\n    ids = _\r\n    return annotation\r\n  }\r\n\r\n  annotation.editMode = function(_) {\r\n    if (!arguments.length) return editMode\r\n    editMode = _\r\n\r\n    if (sel) {\r\n      sel.selectAll(\"g.annotation\").classed(\"editable\", editMode)\r\n    }\r\n\r\n    if (collection) {\r\n      collection.editMode(editMode)\r\n      annotations = collection.annotations\r\n    }\r\n    return annotation\r\n  }\r\n\r\n  annotation.collection = function(_) {\r\n    if (!arguments.length) return collection\r\n    collection = _\r\n    return annotation\r\n  }\r\n\r\n  annotation.on = function() {\r\n    const value = annotationDispatcher.on.apply(annotationDispatcher, arguments)\r\n    return value === annotationDispatcher ? annotation : value\r\n  }\r\n\r\n  return annotation\r\n}\r\n","import annotation from './src/Adapter-d3'\r\nimport { Type, d3Label, d3Callout, d3CalloutCurve, d3CalloutElbow, d3CalloutCircle, \r\n d3CalloutRect, d3XYThreshold, d3Badge, customType } from './src/Types-d3'\r\n\r\nexport {\r\n  annotation,\r\n  Type as annotationTypeBase ,\r\n  d3Label as annotationLabel ,\r\n  d3Callout as annotationCallout ,\r\n  d3CalloutCurve as annotationCalloutCurve ,\r\n  d3CalloutElbow as annotationCalloutElbow ,\r\n  d3CalloutCircle as annotationCalloutCircle ,\r\n  d3CalloutRect as annotationCalloutRect ,\r\n  d3XYThreshold as annotationXYThreshold ,\r\n  d3Badge as annotationBadge ,\r\n  customType as annotationCustomType \r\n}\r\n\r\nexport default {\r\n  annotation,\r\n  annotationTypeBase : Type,\r\n  annotationLabel : d3Label,\r\n  annotationCallout : d3Callout,\r\n  annotationCalloutCurve : d3CalloutCurve,\r\n  annotationCalloutElbow : d3CalloutElbow,\r\n  annotationCalloutCircle : d3CalloutCircle,\r\n  annotationCalloutRect : d3CalloutRect,\r\n  annotationXYThreshold : d3XYThreshold,\r\n  annotationBadge : d3Badge,\r\n  annotationCustomType : customType\r\n}"],"names":["Annotation","x","y","nx","ny","dy","dx","color","data","type","subject","connector","note","disable","id","className","_dx","undefined","_dy","_x","_y","_color","_className","_type","setPosition","selectAll","nodes","length","redrawSubject","clearComponents","setOffset","redrawConnector","redrawNote","setClassName","updatePosition","updateOffset","json","Object","keys","AnnotationCollection","annotations","accessors","accessorsInverse","newSettings","forEach","d","setPositionWithAccessors","editMode","a","updateEditMode","remove","textWrap","updateTextWrap","drawText","notePadding","map","k","getNoteBBoxOffset","positionX","positionY","pointHandle","cx","cy","move","circleHandles","r1","r2","padding","h","Math","sqrt","addHandles","group","handles","r","enter","append","attr","call","drag","container","select","node","on","start","end","exit","leftRightDynamic","align","topBottomDynamic","orientationTopBottom","orientationLeftRight","bbox","width","height","orientation","offset","indexOf","lineBuilder","curve","curveLinear","canvasContext","classID","lineGen","line","builder","context","pathMethods","attrs","arcBuilder","arcShape","arc","innerRadius","outerRadius","radius","startAngle","endAngle","PI","components","lineSetup","subjectType","annotation","position","x1","x2","y1","y2","subjectData","angle","asin","radiusPadding","abs","cos","sin","connectorData","diffY","diffX","xe","ye","opposite","acos","points","createPoints","curveCatmullRom","cHandles","c","i","index","updatePoint","event","mapHandles","bind","anchors","diff","p","push","scale","size","angleOffset","atan","dot","transform","updateRadius","rect","updateWidth","updateHeight","rHandles","typeSettings","notCornerOffset","placement","circlebg","fill","circle","pointer","notCornerPointerXY","v","sign","dragBadge","bHandles","text","Type","dispatcher","noteContent","handler","addHandlers","component","name","offsetCornerX","offsetCornerY","init","mapX","mapY","builders","Array","isArray","filter","b","el","addAttrs","removeAttrs","currentAttrs","attributes","bboxWithoutHandles","split","parseFloat","offsetX","offsetY","subjectParams","subjectCircle","subjectRect","subjectThreshold","subjectBadge","stroke","concat","dragSubject","connectorParams","connectorCurve","connectorElbow","connectorLine","endType","s","e","distance","pow","connectorArrow","endScale","connectorDot","noteData","noteParams","lineType","noteVertical","noteHorizontal","dragNote","dragging","dragstarted","dragended","noteAlignment","drawFunction","drawOnSVG","drawOnScreen","drawSubject","drawConnector","getNoteBBox","drawNoteContent","drawNote","sourceEvent","stopPropagation","classed","style","customType","initialType","settings","babelHelpers.get","babelHelpers.extends","d3NoteText","params","titleBBox","label","wrapLength","wrap","wrapSplitter","bgPadding","bgPaddingFinal","top","bottom","left","right","title","getBBox","d3Label","d3Callout","d3CalloutElbow","d3CalloutCurve","d3Badge","d3CalloutCircle","d3CalloutRect","ThresholdMap","d3XYThreshold","newWithClass","merge","lineHeight","each","words","reverse","w","word","tspan","pop","join","getComputedTextLength","selection","selector","reduce","min","max","yOffset","value","collection","ids","annotationDispatcher","dispatch","sel","translatedAnnotations","annotationG","toString","draw","log","copy","JSON","stringify","update","updateText","updatedAccessors","_","arguments","updateDisable","updateNotePadding","rerun","some","apply"],"mappings":"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"}